
#141: WISH: VID to evaluate parens
================================================================================
Issue is open, was reported by hiiamboris and has 12 comment(s).
[Wish]
<https://github.com/red/REP/issues/141>

This comes up rather frequently:
`view [base (green + red)]` doesn't work.

One has to write boring `view [base with [color: (green + red)]]` or dangerous `view compose/deep [base (green + red)]`. Dangerous because it affects every actor body, not just VID. 

VID could evaluate parens before reacting on their type, since they aren't used anyway.


Comments:
--------------------------------------------------------------------------------

On 2023-03-04T11:03:08Z, luce80, commented:
<https://github.com/red/REP/issues/141#issuecomment-1454700971>

    This is also my wish.
    This is useful for dimensions, positions, colors, text...almost everything.

--------------------------------------------------------------------------------

On 2023-03-06T12:18:44Z, dockimbel, commented:
<https://github.com/red/REP/issues/141#issuecomment-1456033092>

    I get the practical benefits expected from such feature, though, I do have a designer/architect pain point with that. 
    
    VID is a declarative language where literal datatypes denote the semantics. Such dialects are the typical model Rebol was designed for with its rich set of literal forms. 
    
    In VID, we allow to inline some Red expressions in some limited cases, like after `data` keyword, for sake of convenience. However allowing parens everywhere might severely affect the VID readability, as you could then rarely tell which datatype is generated by such parens expressions, so cannot tell which facet is set! I'm not even going into the successive multiline parens madness...
    
    The next change you would then ask for, is to introduce (many) new keywords to improve the lost readability, like `size`, `color`, `position`, `text`,... which would not only result in much more verbose VID code, but also be going fully against the "dialects with rich literal datatypes" concept that Redbol are pushing for... That would also create a problematic precedent for other dialects.
    
    ```
    view [base 200x100 255.0.255 "hello" center]
    ```
    vs
    ```
    view [base (...) (...) (...) (...)]
    ```
    vs
    ```
    view [base size (...) color (...) text (...) align (...)]
    ```
    
    One a side note, one advantage of the current approach is that you are passing to `view` or `layout` a block of VID keywords and values that can be trivially `probe`-d for debugging purposes. In the case where parens are evaluated by VID, you have to probe them one by one from within each paren expression.

--------------------------------------------------------------------------------

On 2023-03-06T14:00:08Z, hiiamboris, commented:
<https://github.com/red/REP/issues/141#issuecomment-1456188433>

    Readability is a good consideration here, however you assume that code author is malicious in the first place. And if he is, he can just uglify the code with `compose` anyway.
    
    From inspecting the code I can tell that both me, you and Gregg are guilty of using `compose` where it's not required e.g. `base (size)` or `text (str)` instead of just `base size` or `text str`. I guess `compose` just clicks faster in our minds than we recall that VID can read values of words just fine. Another misuses I've seen is `text (form thing)` instead of `text data thing`, and `data [(list)]` instead of `data list`.
    
    However there are perfectly valid use cases for such composition, e.g.: `base (some-size / 2)`, `base (as-pair W H)`, `base (black + 0.0.0.254)`, `area (mold msg)`, `base (form type)`, which are self-evident and short.
    
    Another source of `compose` plague is paths. VID does not read paths for some reason, requiring a workaround.
    
    And yet another non-obvious but big use case - linear interpolation https://github.com/red/red/pull/5085. As it's a runtime expression it requires some form of inline evaluation.
    
    There is of course a different solution to this - empower `compose` to be less dangerous. It won't win in readability, but at least would still allow one to probe the composition result.

--------------------------------------------------------------------------------

On 2023-03-06T17:28:15Z, greggirwin, commented:
<https://github.com/red/REP/issues/141#issuecomment-1456584894>

    I use compose because then I know it will work. :^) It's the "limited cases" part that makes me question things otherwise. Also, it makes all the bits being composed in stand out. Making VID eval by default also changes the nature of the dialect (less declarative, more Turing). We can do that of course, it's just a choice. 
    
    Certainly, we've all run into cases where `compose` was a pain. With VID it's easy to run up against its limits, which is the tradeoff for keeping it simple. `Spaces` is meant for more complex UIs, and then we have to figure out if we can extend VID in that direction enough to be worth the extra complexity. Or do we just say "use Spaces"? Rather than going feature by feature, though, it would be better to design VID+ with clear goals (part of the specs project perhaps) and mock that up.

--------------------------------------------------------------------------------

On 2023-03-12T16:54:29Z, luce80, commented:
<https://github.com/red/REP/issues/141#issuecomment-1465246872>

    Do you really think that once we can use evaluated `paren`s we will avoid using the easier literal datatypes ? 

--------------------------------------------------------------------------------

On 2023-03-12T18:31:08Z, greggirwin, commented:
<https://github.com/red/REP/issues/141#issuecomment-1465268270>

    I think people will use parens more if the are easier to use, like anything else. The question is whether that's a good thing. It's a mixed bag today, partly due to VID being design for simplicity. It's also because we don't have advanced examples or best practices that are officially blessed. Everyone does their own thing. 
    
    For example, there are two ways you can use indirection for facets, which may be mixed in any given layout:
    ```
    >> sz: 640x480
    == 640x480
    >> view [size sz]
    >> view compose [size (sz)]
    >> view [size (sz)]
    *** Script Error: VID - invalid syntax at: [(sz)]
    *** Where: do
    *** Near : panel/size: size: fetch-argument pair! spec
    *** Stack: view layout fetch-argument cause-error  
    ```
    Is it better to use plain words? Will it work consistently for all facets? Do you use compose, then find the cases where plain words work and refactor those? We can probably all agree that hardcoding literal values gets you only so far, and soon you want some level of indirection. But maybe another solution here is native resizing. That also complicates VID, as you have more things to specify, but it is still a declarative model.
    
    Then we have the analysis side, where declarative dialects that leverage literal datatypes are much easier to write tooling for. 

