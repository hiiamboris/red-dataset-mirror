
#112: WISH: URLs to support parens `()` for string interpolation
================================================================================
Issue is open, was reported by hiiamboris and has 24 comment(s).
<https://github.com/red/REP/issues/112>

It is currently possible to use string interpolation with strings, tags and files:
```
"(now as {hhh:mi:ss}): (value) is invalid in (mold spec)"
{(now as "hhh:mi:ss"): (value) is invalid in (mold spec)}
%"(drive):\(path)\file-(idx as "000.").(ext)"
<img src=(url) width=(width as "0")>
```
Would be nice if URL could join the band:
```
http://(site)/(resource)?param=(date as "yyyy")
```
Since `x:(1 + 2)` is valid Red code for a set-word and a paren, I propose that paren support gets toggled on after `:/` only. Anyway `http://`/`https://` will be the vast majority of use cases, with `file://` probably following. `mailto:` cannot be supported.

Workaround is possible right now: `as url! #rejoin "http://(site)/(resource)?param=(date as "yyyy")"` but still having URLs work out of the box would be cool.


Comments:
--------------------------------------------------------------------------------

On 2022-02-22T18:23:29Z, dumblob, commented:
<https://github.com/red/REP/issues/112#issuecomment-1048085307>

    Just a side note - the parens should not interfere with literal parens in URLs (yes, URLs can contain parens).

--------------------------------------------------------------------------------

On 2022-02-22T18:38:26Z, hiiamboris, commented:
<https://github.com/red/REP/issues/112#issuecomment-1048097882>

    They can, just not easily...
    ```
    >> to url! "http://(stuff)"
    == http://(stuff)
    ```
    well, that was a failure
    ```
    >> to url! enhex "http://(stuff)"
    == http%253A%252F%252F%2528stuff%2529
    ```
    okay, this too :/
    ```
    >> rejoin [http:// enhex "(stuff)"]
    == http://%2528stuff%2529
    ```
    got it right this time
    
    point of this wish is to write `()` instead of `%2528%2529` that's all

--------------------------------------------------------------------------------

On 2022-02-22T19:39:46Z, dumblob, commented:
<https://github.com/red/REP/issues/112#issuecomment-1048146747>

    > ```
    > >> to url! "http://(stuff)"
    > == http://(stuff)
    > ```
    > 
    > well, that was a failure
    
    Hm, why a failure? That should be fine according to RFC, right?

--------------------------------------------------------------------------------

On 2022-02-22T19:56:27Z, hiiamboris, commented:
<https://github.com/red/REP/issues/112#issuecomment-1048159369>

    Failure because it's currently not loadable. I guess design of `mold` is not finished in the area of url-encoding.

--------------------------------------------------------------------------------

On 2022-02-22T19:58:52Z, hiiamboris, commented:
<https://github.com/red/REP/issues/112#issuecomment-1048161317>

    I expected smth like in R2:
    ```
    >> to url! "http://(stuff)"
    == http://%28stuff%29
    ```
    Also wondering why Red says `%2528` and not `%28` and so on.

--------------------------------------------------------------------------------

On 2022-02-22T20:00:51Z, hiiamboris, commented:
<https://github.com/red/REP/issues/112#issuecomment-1048162937>

    https://www.codetable.net/decimal/9512
    Looks like a bug.

--------------------------------------------------------------------------------

On 2022-02-22T20:06:22Z, hiiamboris, commented:
<https://github.com/red/REP/issues/112#issuecomment-1048167472>

    Figured it out.
    ```
    >> rejoin ["http://" enhex "(stuff)"]
    == "http://%28stuff%29"
    ```
    URL when molded runs enhex again, so we get `%25` for every `%`

--------------------------------------------------------------------------------

On 2022-02-22T22:18:09Z, dumblob, commented:
<https://github.com/red/REP/issues/112#issuecomment-1048265971>

    Now I see what you mean. But contrary to that what I was pointing at is the fact that https://en.wikipedia.org/wiki/Kush_(cannabis) is a valid URL as it stands (so we should **not** actually expect it to be converted to `https://en.wikipedia.org/wiki/Kush_%28cannabis%29`).

--------------------------------------------------------------------------------

On 2022-02-23T12:55:22Z, hiiamboris, commented:
<https://github.com/red/REP/issues/112#issuecomment-1048753437>

    Latter URL works though. But I think you're correct:
    <a href=https://datatracker.ietf.org/doc/html/rfc3986#section-2.2><img src=https://i.gyazo.com/510a7a96964c2fed090c546b029b8eb6.png></img></a>
    
    So RFC 3986 supports this wish:
    - `()` and `%28%29` should not be converted to each other
    - `()` should be loadable for that
    - current `mold` implementation is correct to leave `()` as is
    - characters `[];` are also currently not treated as part of the URL, but they should be

--------------------------------------------------------------------------------

On 2022-02-25T03:15:00Z, greggirwin, commented:
<https://github.com/red/REP/issues/112#issuecomment-1050479195>

    IPv6 lexical support has been added in a branch by @dockimbel. I agree that parens should be allowed in URLs, per the spec and also pragmatically.

--------------------------------------------------------------------------------

On 2023-11-17T16:33:54Z, rebolek, commented:
<https://github.com/red/REP/issues/112#issuecomment-1816735064>

    String interpolation in URLs makes sense but I would prefer to use `{` and `}` which are invalid in URL and usually used in API docs for user values anyways.

--------------------------------------------------------------------------------

On 2023-11-17T16:36:44Z, hiiamboris, commented:
<https://github.com/red/REP/issues/112#issuecomment-1816739153>

    Per [RFC](https://datatracker.ietf.org/doc/html/rfc3986#section-2.2) `{}` are not *reserved* as `()[]` so they are even more valid than parens in URLs.

